{"messages": [{"role": "system", "content": "You are a NuCore smart-home assistant. You convert the user\u2019s request into one or more NuCore routines based on the provided DEVICE STRUCTURE."}, {"role": "user", "content": "DEVICE STRUCTURE:\n***Device***\nName: new motion sensor-Dusk.Dawn\nID: 21 D6 AB 2\nParent: new motion sensor-Sensor [ID: 21 D6 AB 1]\n  ***Properties***\n    Status [id=ST]\n      Enum [uom id=51]\n        Off [0]\n        On [100]\n    Responding [id=ERR]\n      Enum [uom id=25]\n        True [0]\n        False [1]\n  ***Accept Commands***\n    Query [id=QUERY]\n    Beep [id=BEEP]\n        Parameter 1: name=n/a [id=n/a]\n          Enum [uom id=100]\n    Write Changes [id=WDU]\n  ***Send Commands***\n    On [id=DON]\n    Off [id=DOF]\n    Fast On [id=DFON]\n    Fast Off [id=DFOF]***Device***\nName: new motion sensor-Low Bat\nID: 21 D6 AB 3\nParent: new motion sensor-Sensor [ID: 21 D6 AB 1]\n  ***Properties***\n    Status [id=ST]\n      Enum [uom id=51]\n        Off [0]\n        On [100]\n    Responding [id=ERR]\n      Enum [uom id=25]\n        True [0]\n        False [1]\n  ***Accept Commands***\n    Query [id=QUERY]\n    Beep [id=BEEP]\n        Parameter 1: name=n/a [id=n/a]\n          Enum [uom id=100]\n    Write Changes [id=WDU]\n  ***Send Commands***\n    On [id=DON]\n    Off [id=DOF]\n    Fast On [id=DFON]\n    Fast Off [id=DFOF]***Device***\nName: Sliding Glass Door\nID: 32 AF 85 1\n  ***Properties***\n    Status [id=ST]\n      Enum [uom id=51]\n        Off [0]\n        On [100]\n    Responding [id=ERR]\n      Enum [uom id=25]\n        True [0]\n        False [1]\n  ***Accept Commands***\n    Query [id=QUERY]\n    Beep [id=BEEP]\n        Parameter 1: name=n/a [id=n/a]\n          Enum [uom id=100]\n    Write Changes [id=WDU]\n  ***Send Commands***\n    On [id=DON]\n    Off [id=DOF]\n    Fast On [id=DFON]\n    Fast Off [id=DFOF]\n\nUSER QUERY: When the Dusk.Dawn motion sensor turns ON at sunset, query the Sliding Glass Door and then query the sensor itself."}, {"role": "assistant", "content": "__BEGIN_NUCORE_ROUTINE__\n{\n  \"routine\": {\n    \"id\": 101,\n    \"name\": \"Motion After Sunset -> Query Door and Sensor\",\n    \"parent\": 0,\n    \"comment\": \"When motion detected at sunset, poll door and sensor\",\n    \"if\": [\n      { \"==\": { \"device\": \"21 D6 AB 2\", \"status\": \"ST\", \"value\": 100, \"uom\": \"51\", \"precision\": 0 } },\n      { \"and\": 1 },\n      { \"at\": { \"sunset\": 0 } }\n    ],\n    \"then\": [\n      { \"device\": \"32 AF 85 1\", \"command\": \"QUERY\", \"parameters\": [] },\n      { \"device\": \"21 D6 AB 2\", \"command\": \"QUERY\", \"parameters\": [] }\n    ],\n    \"else\": [],\n    \"reasoning\": \"Trigger on COS of Dusk.Dawn status becoming On (value 100). Constrain to sunset event to limit to evening activations. Then poll the sliding door and the motion sensor (both accept QUERY) to get current states for logging/automation.\" \n  }\n}\n__END_NUCORE_ROUTINE__"}]}
