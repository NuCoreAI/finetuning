{"messages": [{"role": "system", "content": "You are a NuCore smart-home assistant. You convert the user\u2019s request into one or more NuCore routines based on the provided DEVICE STRUCTURE."}, {"role": "user", "content": "DEVICE STRUCTURE:\n***Device***\nName: ratgdov25i-4a1a79-Door\nID: n018_eh9834cfaf_dr\nParent: ratgdov25i-4a1a79 [ID: n018_eh9834cfaf]\n  ***Properties***\n    Door State [id=ST]\n      Enum [uom id=25]\n        Closed [0]\n        Open [1]\n        Stopped [2]\n        Closing [3]\n        Opening [4]\n        Unknown [9]\n        Unknown [9]\n    Obstruction [id=GV1]\n      Enum [uom id=25]\n        Clear [0]\n        Obstructed [1]\n        Unknown [101]\n        Unknown [101]\n  ***Accept Commands***\n    Open [id=DON]\n    Close [id=DOF]\n    Stop [id=STOP]\n    Toggle [id=TOGGLE]\n  ***Send Commands***\n    Open [id=DON]\n    Close [id=DOF]***Device***\nName: ratgdov25i-4a1a79-Light\nID: n018_eh9834cfaf_lt\nParent: ratgdov25i-4a1a79 [ID: n018_eh9834cfaf]\n  ***Properties***\n    Status [id=ST]\n  ***Accept Commands***\n    On [id=DON]\n    Off [id=DOF]\n    Fast On [id=DFON]\n    Fast Off [id=DFOF]\n  ***Send Commands***\n    On [id=DON]\n    Off [id=DOF]***Device***\nName: ratgdov25i-4a1a79-Motion\nID: n018_eh9834cfaf_mo\nParent: ratgdov25i-4a1a79 [ID: n018_eh9834cfaf]\n  ***Properties***\n    Motion [id=ST]\n      Enum [uom id=25]\n        Clear [0]\n        Detected [1]\n        Unknown [101]\n        Unknown [101]\n    Last Detected [id=GV3]\n  ***Send Commands***\n    Motion Detected [id=DON]\n\nUSER QUERY: When motion is detected after sunset, turn on the light and open the door. If there is no motion at sunrise, close the door and turn off the light."}, {"role": "assistant", "content": "__BEGIN_NUCORE_ROUTINE__\n{\n  \"routine\": {\n    \"id\": 1,\n    \"name\": \"Motion after sunset: light on and door open\",\n    \"parent\": 0,\n    \"comment\": \"Turn on light and open door when motion is detected at sunset\",\n    \"if\": [\n      { \"at\": { \"sunset\": 0 } },\n      { \"and\": 1 },\n      { \"==\": { \"device\": \"n018_eh9834cfaf_mo\", \"control\": \"DON\" } }\n    ],\n    \"then\": [\n      { \"device\": \"n018_eh9834cfaf_lt\", \"command\": \"DON\", \"parameters\": [] },\n      { \"device\": \"n018_eh9834cfaf_dr\", \"command\": \"DON\", \"parameters\": [] }\n    ],\n    \"else\": [],\n    \"reasoning\": \"When the motion sensor emits a Motion Detected event (COC) at sunset, the user wants the area illuminated and the door opened for entry. This routine triggers on the motion send-command together with the sunset moment and issues the light ON and door OPEN commands.\"\n  }\n}\n__END_NUCORE_ROUTINE__\n__BEGIN_NUCORE_ROUTINE__\n{\n  \"routine\": {\n    \"id\": 2,\n    \"name\": \"Sunrise: close door and turn off light if no motion\",\n    \"parent\": 0,\n    \"comment\": \"At sunrise, if motion state is Clear, ensure door closed and lights off\",\n    \"if\": [\n      { \"at\": { \"sunrise\": 0 } },\n      { \"and\": 1 },\n      { \"==\": { \"device\": \"n018_eh9834cfaf_mo\", \"status\": \"ST\", \"value\": 0, \"uom\": \"25\", \"precision\": 0 } }\n    ],\n    \"then\": [\n      { \"device\": \"n018_eh9834cfaf_dr\", \"command\": \"DOF\", \"parameters\": [] },\n      { \"device\": \"n018_eh9834cfaf_lt\", \"command\": \"DOF\", \"parameters\": [] }\n    ],\n    \"else\": [],\n    \"reasoning\": \"At sunrise, if the motion property is Clear (no recent detection), close the door and switch lights off to save energy. This checks the motion ST value at the sunrise schedule and issues door CLOSE and light OFF commands.\"\n  }\n}\n__END_NUCORE_ROUTINE__"}]}
