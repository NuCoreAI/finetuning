{"messages": [{"role": "system", "content": "You are a NuCore smart-home assistant. You convert the user\u2019s request into one or more NuCore routines based on the provided DEVICE STRUCTURE."}, {"role": "user", "content": "DEVICE STRUCTURE:\n***Device***\nName: ZY 009 Tamper Alarm\nID: ZY009_157\nParent: Shower Water (ZY009) [ID: ZY009_1]\n  ***Properties***\n    Status [id=ST]\n      Enum [uom id=78]\n        Off [0]\n        On [100]\n  ***Accept Commands***\n    Query [id=QUERY]\n  ***Send Commands***\n    On [id=DON]\n    Off [id=DOF]***Device***\nName: ZY 009 Power Alarm\nID: ZY009_309\nParent: Shower Water (ZY009) [ID: ZY009_1]\n  ***Properties***\n    Power Management [id=ALARM]\n  ***Accept Commands***\n    Query [id=QUERY]***Device***\nName: ZY 009 Water Sensor\nID: ZY009_159\nParent: Shower Water (ZY009) [ID: ZY009_1]\n  ***Properties***\n    Status [id=ST]\n      Enum [uom id=78]\n        Off [0]\n        On [100]\n  ***Accept Commands***\n    Query [id=QUERY]\n  ***Send Commands***\n    On [id=DON]\n    Off [id=DOF]\n\nUSER QUERY: When the ZY 009 Water Sensor turns on, query the ZY 009 Power Alarm and the ZY 009 Tamper Alarm immediately."}, {"role": "assistant", "content": "__BEGIN_NUCORE_ROUTINE__\n{\n  \"routine\": {\n    \"id\": 101,\n    \"name\": \"Water detected - query alarms\",\n    \"parent\": 0,\n    \"comment\": \"Query power and tamper alarms when water sensor changes to On\",\n    \"if\": [\n      { \"==\": { \"device\": \"ZY009_159\", \"status\": \"ST\", \"value\": 100, \"uom\": \"78\", \"precision\": 0 } }\n    ],\n    \"then\": [\n      { \"device\": \"ZY009_309\", \"command\": \"QUERY\" },\n      { \"device\": \"ZY009_157\", \"command\": \"QUERY\" }\n    ],\n    \"else\": [],\n    \"reasoning\": \"Trigger on the Water Sensor COS to immediately poll the Power Alarm and Tamper Alarm so their current states are captured for diagnostics and response. Uses only defined QUERY command on each device.\"\n  }\n}\n__END_NUCORE_ROUTINE__"}]}
