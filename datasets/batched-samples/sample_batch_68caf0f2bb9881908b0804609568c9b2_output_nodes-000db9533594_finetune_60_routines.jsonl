{"messages": [{"role": "system", "content": "You are a NuCore smart-home assistant. You convert the user\u2019s request into one or more NuCore routines based on the provided DEVICE STRUCTURE.\n\n## NuCore BASICS\nNuCore is a platform for managing and automating smart devices through structured commands and logic.\nDevices are provided in a flattened format under DEVICE STRUCTURE.\nEach device begins with the label \"***Device***\" and may include:\n\n1. Properties: Real-time values such as status, temperature, brightness\n2. Accepts Commands: Actions that can be sent to the device (e.g., DON, DOF)\n3. Sends Commands: Events emitted by the device\n4. Parameters: Attributes for commands \u2014 id, name, type, unit (UOM), precision, enum, or range\n\nNOTE: Device boundaries are defined by the \"***Device***\" labels. Never mix properties or commands across devices.\n\n## Change of State (COS) \nA COS event occurs when a device property or status transitions from one value to another (e.g., OFF \u2192 ON, Closed \u2192 Open, 72\u00b0F \u2192 73\u00b0F). It represents the moment of change, not the steady state.\n\n## Change of Control (COC):\nA COC event occurs when a device is physically controlled (e.g., tapping a wall switch, pressing a button, adjusting a knob), regardless of whether the state actually changes. It represents the act of human control, not just the resulting status.\n\n## When to Act\nWhen the user asks for automated and optimized behavior. Such as \"turn on the security system when I leave home\", or \"charge my car when prices are lowest\", or \"water the plants every Tuesday, Thursday, Friday from 9AM to 11AM but not when it's raining\", etc.\n\n\n## Output Format (strict)\n\nReturn only:\nOne or more fenced NuCore routine blocks (no prose between blocks). Each block is embedded between __BEGIN_NUCORE_ROUTINE__\nand __END_NUCORE_ROUTINE__ as follows:\n\n__BEGIN_NUCORE_ROUTINE__\n{\n  \"routine\": {\n    \"id\": <int>,\n    \"name\": \"<descriptive name>\",\n    \"parent\": 0,\n    \"comment\": \"<optional>\",\n    \"if\": [ /* ordered flat Condition Tokens */ ],\n    \"then\": [ /* actions */ ],\n    \"else\": [ /* actions */ ],\n    \"reasoning\": \"<assistant's reasoning for the structure and semantics of this routine>\" \n  }\n}\n__END_NUCORE_ROUTINE__\n\n\n- \"parent\" required (`0` = root)\n- \"if\" = flat ordered array of tokens (no nesting)\n- \"then\"/\"else\" = arrays of actions\n- \"value\" integer only; decimals via \"precision\"\n- \"reasoning\" is optional and must be IGNORED if requested \n- If the request is ambiguous, follow up with a CLARIFY stucture as defined below\n__BEGIN_NUCORE_ROUTINE_CLARIFY__\n{\n  \"clarify\": \"The requested clarification content and question\",\n  \"reasoning\": \"optional clear, concise, and contextal reasoning generated by the assistant.\" \n}\n__END_NUCORE_ROUTINE_CLARIFY__\n\n---\n\n**Condition Tokens**\n\n- COS (Change of State):\n  { \">=\": { \"device\":\"13 18 26_1\",\"status\":\"ST\",\"value\":7500,\"uom\":\"17\",\"precision\":2 } }\n- COC (Change of Control):\n  { \"==\": { \"device\":\"18 18 18\",\"control\":\"DFON\",\"parameters\":[{ \"name\":\"tapCount\",\"value\":2,\"uom\":\"108\",\"precision\":0 }] } }\n- Schedules (13 forms, **exact syntax**):\n  1. `{ \"at\": { \"time\": \"13:00\" } }`\n  2. `{ \"at\": { \"sunrise\": -900 } }`\n  3. `{ \"at\": { \"sunset\": 600 } }`\n  4. `{ \"from\": { \"sunrise\": 0, \"for\": { \"hours\":1,\"minutes\":30,\"seconds\":0 } } }`\n  5. `{ \"from\": { \"sunrise\": 0, \"to\": { \"sunset\": 0 } } }`\n  6. `{ \"from\": { \"sunrise\": 0, \"to\": { \"sunset\": 0, \"day\":1 } } }`\n  7. `{ \"from\": { \"time\":\"13:00\",\"to\":{ \"sunset\":0,\"day\":1 } } }`\n  8. `{ \"from\": { \"time\":\"09:00\",\"to\":{ \"time\":\"18:00\",\"day\":0 } } }`\n  9. `{ \"at\": { \"time\":\"08:30\",\"date\":\"2025/09/03\" } }`\n  10. `{ \"from\": { \"time\":\"08:30\",\"date\":\"2025/09/03\",\"for\":{ \"hours\":2,\"minutes\":0,\"seconds\":0 } } }`\n  11. `{ \"from\": { \"time\":\"08:30\",\"date\":\"2025/09/03\",\"to\":{ \"time\":\"17:00\",\"date\":\"2025/09/04\" } } }`\n  12. `{ \"from\": { \"time\":\"22:00\",\"to\":{ \"time\":\"06:00\",\"day\":1 } } }`\n  13. `{ \"weekly\": { \"days\":\"sun,mon,tue,wed,thu,fri,sat\",\"from\":{ \"time\":\"09:00\",\"to\":{ \"time\":\"17:00\" } } } }`\n    - Alt weekly: use `\"for\": { \"hours\":2,\"minutes\":0,\"seconds\":0 }`\n    - Days string lowercase, canonical, no spaces\n  NOTE: The sunrise and sunset values are integer offsets in seconds from the event: negative = before, positive = after, 0 = exactly at the event.\n\n- Logical operators\n{ \"and\": 1 }\n{ \"or\": 1 }\n{ \"(\": 1 }\n{ \")\": 1 }\nLogical operators mimic natural language flows and do not contain objects.\nWrite logical operators exactly as:\n{ \"(\": 1 } and { \")\": 1 }\nDo not escape parentheses. Only escape double quotes where JSON requires it.\n\n- Mathematical operators\nUse their natural language form: >, >=, <, <=, == (is or equals to), =! (is not)\n\nExamples:\n\n-- COS + Schedule + Price\n\"if\": [\n  { \"at\": { \"sunset\": 0 } },\n  { \"and\": 1 },\n  { \"<\": { \"device\": \"id_for_price_sensor\", \"status\": \"ST\", \"value\": 350, \"uom\": \"33\", \"precision\": 2 } },\n  { \"and\": 1 },\n  { \">=\": { \"device\": \"id_for_hvac\", \"status\": \"ST\", \"value\": 7000, \"uom\": \"17\", \"precision\": 2 } }\n]\n\n\"if\": [\n  { \"<\": { \"device\": \"id_for_price_sensor\", \"status\": \"ST\", \"value\": 350, \"uom\": \"33\", \"precision\": 2 } },\n  { \"and\": 1 },\n  { \"at\": { \"sunset\": 0 } },\n  { \"or\": 1 },\n  { \">=\": { \"device\": \"id_for_hvac\", \"status\": \"ST\", \"value\": 7000, \"uom\": \"17\", \"precision\": 2 } }\n]\n\n-- Grouped COS + COC + Weekly\n\"if\": [\n  { \"(\": 1 },\n    { \"==\": { \"device\": \"id_for_device_1\", \"control\": \"DFON\" } },\n    { \"or\": 1 },\n    { \"==\": { \"device\": \"id_for_device_2\", \"control\": \"DON\" } },\n  { \")\": 1 },\n  { \"and\": 1 },\n  { \"weekly\": { \"days\": \"mon,tue,wed,thu,fri\", \"from\": { \"time\": \"08:00\", \"to\": { \"time\": \"18:00\" } } } }\n]\n\n-- Multiple Groups, Mixed Triggers\n\"if\": [\n  { \"(\": 1 },\n    { \">\": { \"device\": \"id_for_thermostat_1\", \"status\": \"ST\", \"value\": 7500, \"uom\": \"17\", \"precision\": 2 } },\n    { \"and\": 1 },\n    { \"<\": { \"device\": \"id_for_price_sensor\", \"status\": \"ST\", \"value\": 250, \"uom\": \"33\", \"precision\": 2 } },\n  { \")\": 1 },\n  { \"or\": 1 },\n  { \"at\": { \"sunrise\": 600 } },\n  { \"or\": 1 },\n  { \"IS\": { \"device\": \"fan\", \"control\": \"DFON\" } }\n]\n\n---\n\n**Actions**\n{\n  \"device\":\"<device id>\",\n  \"command\":\"<command name>\",\n  \"parameters\":[\n    { \"name\":\"<parameter name>\",\"value\":<a number>,\"uom\":\"<uom id>\",\"precision\":2 }\n  ]\n}\n\n\n- Use device ID for device\n- Use correct UOM ID for uom\n- Commands must exist in device\u2019s `accepts` list\n- Use accurate ids, names, and precisions from DEVICE STRUCTURE\n\n---\n\n## CRITICAL RULES\n\n- Do provide reasoning, thinking, or any explanations **unless** otherwise requested\n- Put reasoning inside the routine schema \n- Do **not** guess, invent, or hallucinate IDs, parameters, units, or values.\n- Only use what is explicitly defined in the DEVICE STRUCTURE.\n- Remain minimal, structured, and consistent.\n- All other answers must be short, factual, and grounded.\n\n---"}, {"role": "user", "content": "DEVICE STRUCTURE: ***Device*** Name: Pioneer 2 ID: n010_d60308906 Parent: Elite Hub5158 [ID: n010_h51415fc31d16b]   ***Accept Commands***     Command [id=SET_BUTTON]         Parameter 1: name=n/a [id=n/a]           Enum [uom id=25]             PowerOff [0]             PowerOn [1]             PowerToggle [2]             Dot [3]             Number0 [4]             Number1 [5]             Number2 [6]             Number3 [7]             Number4 [8]             Number5 [9]             Number6 [10]             Number7 [11]             Number8 [12]             Number9 [13]             Mute [14]             VolumeDown [15]             VolumeUp [16]             PrevChannel [17]             ChannelDown [18]             ChannelUp [19]             DirectionDown [20]             DirectionLeft [21]             DirectionRight [22]             DirectionUp [23]             Select [24]             Stop [25]             Play [26]             Rewind [27]             Pause [28]             FastForward [29]             Return [30]             Menu [31]             PipSwap [32]             Exit [33]             Display [34]             AvSelection [35]             ChannelEnter [36]             Freeze [37]             HdmiControl [38]             Input1 [39]             Input2 [40]             Input3 [41]             Input4 [42]             Input5 [43]             Input6 [44]             Input7 [45]             InputPc [46]             PipShift [47]             PipSplit [48]             ScreenSize [49]             ServiceMenu [50]             Tools [51]             Tv/Dtv [52]             SkipBackward [53]             SkipForward [54]             Back [55]             PageDown [56]             PageUp [57]             Home [58]             NextChapter [59]             Pair [60]             PrevChapter [61]             Reset [62]             UnPair [63]             VideoMode [64]             In/OutMode [65]             Master [66]             MultiZone [67]             Slave [68]             Zone1 [69]             Zone2 [70]             Zone3 [71]             Zone4 [72]             Zone5 [73]             Zone6 [74]             Zone7 [75]             ZoneA [76]             ZoneB [77]             IR001 [78]             IR002 [79]             IR003 [80]             IR004 [81]             IR005 [82]             IR006 [83]             IR007 [84]             IR008 [85]             IR009 [86]             IR010 [87]             IR011 [88]             IR012 [89]             IR013 [90]             IR014 [91]             IR015 [92]             IR016 [93]             IR017 [94]             IR018 [95]             IR019 [96]             IR020 [97]             IR021 [98]             IR022 [99]             IR023 [100]             IR024 [101]             IR025 [102]             IR026 [103]             IR027 [104]             IR028 [105]             IR029 [106]             IR030 [107]             IR031 [108]             IR032 [109]             IR033 [110]             IR034 [111]             IR035 [112]             IR036 [113]             IR037 [114]             IR038 [115]             IR039 [116]             IR040 [117]             IR041 [118]             IR042 [119]             Search [120]             PrevPreset [121]             ScanDown [122]             ScanUp [123]             NextPreset [124]             Setup [125]             Sleep [126]             ChannelLevel [127]             DirectPlay-AllMusic/Favorites [128]             DirectPlay-USB [129]             DTUBand [130]             DTUBankA [131]             DTUBankB [132]             DTUBankC [133]             DTUBankD [134]             DTUBankE [135]             DTUBankF [136]             DTUBankG [137]             DTUKey0 [138]             DTUKey1 [139]             DTUKey2 [140]             DTUKey3 [141]             DTUKey4 [142]             DTUKey5 [143]             DTUKey6 [144]             DTUKey7 [145]             DTUKey8 [146]             DTUKey9 [147]             DTUMemory [148]             DTUTuneDown [149]             DTUTuneUp [150]             DTUTuningMode [151]             DynamicEq [152]             DynamicVolume [153]             InputCd [154]             InputDtu [155]             InputDvd [156]             InputDvr [157]             InputHdp [158]             InputiPod [159]             InputNet/Usb [160]             InputPhono [161]             InputSat/Cbl [162]             InputSatTu [163]             InputTuner [164]             InputTv [165]             InputV.Aux [166]             InputVcr [167]             IpodPause [168]             iPodRepeat [169]             iPodReturn [170]             iPodSearch [171]             iPodShuffle [172]             Mode5Ch/7Ch [173]             ModeCinema [174]             ModeDirect/Stereo [175]             ModeGame [176]             ModeMusic [177]             ModePure [178]             ModeSimu [179]             ModeStandard [180]             ModeStereo [181]             MonitorSelect [182]             MultiEq [183]             NetUsbD [184]             NetUsbDown [185]             NetUsbE [186]             NetUsbF [187]             NetUsbG [188]             NetUsbLeft [189]             NetUsbMemory [190]             NetUsbRight [191]             NetUsbSearch [192]             NetUsbSelect [193]             NetUsbUp [194]             Party [195]             PowerOff-MainZone [196]             PowerOn-MainZone [197]             QuickSelect1 [198]             QuickSelect2 [199]             QuickSelect3 [200]             RestorerMode [201]             Speaker [202]             TunerBand [203]             TunerMemory [204]             TunerMode [205]             VideoSelect [206]             Zone 2 Off [207]             Zone 2 On [208]             Zone 2 Volume Down [209]             Zone 2 Volume Up [210]             Zone 3 Off [211]             Zone 3 On [212]             Zone 3 Volume Down [213]             Zone 3 Volume Up [214]             Plus [215]             Eject [216]             TopMenu [217]             Subtitle [218]             Audio [219]             Angle [220]             Cross [221]             Circle [222]             Square [223]             Triangle [224]             Green [225]             Red [226]             Blue [227]             Yellow [228]             InstantLeft [229]             InstantRight [230]             L1 [231]             L2 [232]             L3 [233]             PS [234]             PSHold [235]             R1 [236]             R2 [237]             R3 [238]             SlowNext [239]             SlowPrev [240]             Start [241]             Time [242]             InputVAux [243]             InputDvr/Vcr [244]             InputV-Aux [245]             Reboot [246]     On [id=DON]     Off [id=DOF] ***Device*** Name: Apple TV ID: n010_d60308905 Parent: Elite Hub5158 [ID: n010_h51415fc31d16b]   ***Accept Commands***     Command [id=SET_BUTTON]         Parameter 1: name=n/a [id=n/a]           Enum [uom id=25]             PowerOff [0]             PowerOn [1]             PowerToggle [2]             Dot [3]             Number0 [4]             Number1 [5]             Number2 [6]             Number3 [7]             Number4 [8]             Number5 [9]             Number6 [10]             Number7 [11]             Number8 [12]             Number9 [13]             Mute [14]             VolumeDown [15]             VolumeUp [16]             PrevChannel [17]             ChannelDown [18]             ChannelUp [19]             DirectionDown [20]             DirectionLeft [21]             DirectionRight [22]             DirectionUp [23]             Select [24]             Stop [25]             Play [26]             Rewind [27]             Pause [28]             FastForward [29]             Return [30]             Menu [31]             PipSwap [32]             Exit [33]             Display [34]             AvSelection [35]             ChannelEnter [36]             Freeze [37]             HdmiControl [38]             Input1 [39]             Input2 [40]             Input3 [41]             Input4 [42]             Input5 [43]             Input6 [44]             Input7 [45]             InputPc [46]             PipShift [47]             PipSplit [48]             ScreenSize [49]             ServiceMenu [50]             Tools [51]             Tv/Dtv [52]             SkipBackward [53]             SkipForward [54]             Back [55]             PageDown [56]             PageUp [57]             Home [58]             NextChapter [59]             Pair [60]             PrevChapter [61]             Reset [62]             UnPair [63]             VideoMode [64]             In/OutMode [65]             Master [66]             MultiZone [67]             Slave [68]             Zone1 [69]             Zone2 [70]             Zone3 [71]             Zone4 [72]             Zone5 [73]             Zone6 [74]             Zone7 [75]             ZoneA [76]             ZoneB [77]             IR001 [78]             IR002 [79]             IR003 [80]             IR004 [81]             IR005 [82]             IR006 [83]             IR007 [84]             IR008 [85]             IR009 [86]             IR010 [87]             IR011 [88]             IR012 [89]             IR013 [90]             IR014 [91]             IR015 [92]             IR016 [93]             IR017 [94]             IR018 [95]             IR019 [96]             IR020 [97]             IR021 [98]             IR022 [99]             IR023 [100]             IR024 [101]             IR025 [102]             IR026 [103]             IR027 [104]             IR028 [105]             IR029 [106]             IR030 [107]             IR031 [108]             IR032 [109]             IR033 [110]             IR034 [111]             IR035 [112]             IR036 [113]             IR037 [114]             IR038 [115]             IR039 [116]             IR040 [117]             IR041 [118]             IR042 [119]             Search [120]             PrevPreset [121]             ScanDown [122]             ScanUp [123]             NextPreset [124]             Setup [125]             Sleep [126]             ChannelLevel [127]             DirectPlay-AllMusic/Favorites [128]             DirectPlay-USB [129]             DTUBand [130]             DTUBankA [131]             DTUBankB [132]             DTUBankC [133]             DTUBankD [134]             DTUBankE [135]             DTUBankF [136]             DTUBankG [137]             DTUKey0 [138]             DTUKey1 [139]             DTUKey2 [140]             DTUKey3 [141]             DTUKey4 [142]             DTUKey5 [143]             DTUKey6 [144]             DTUKey7 [145]             DTUKey8 [146]             DTUKey9 [147]             DTUMemory [148]             DTUTuneDown [149]             DTUTuneUp [150]             DTUTuningMode [151]             DynamicEq [152]             DynamicVolume [153]             InputCd [154]             InputDtu [155]             InputDvd [156]             InputDvr [157]             InputHdp [158]             InputiPod [159]             InputNet/Usb [160]             InputPhono [161]             InputSat/Cbl [162]             InputSatTu [163]             InputTuner [164]             InputTv [165]             InputV.Aux [166]             InputVcr [167]             IpodPause [168]             iPodRepeat [169]             iPodReturn [170]             iPodSearch [171]             iPodShuffle [172]             Mode5Ch/7Ch [173]             ModeCinema [174]             ModeDirect/Stereo [175]             ModeGame [176]             ModeMusic [177]             ModePure [178]             ModeSimu [179]             ModeStandard [180]             ModeStereo [181]             MonitorSelect [182]             MultiEq [183]             NetUsbD [184]             NetUsbDown [185]             NetUsbE [186]             NetUsbF [187]             NetUsbG [188]             NetUsbLeft [189]             NetUsbMemory [190]             NetUsbRight [191]             NetUsbSearch [192]             NetUsbSelect [193]             NetUsbUp [194]             Party [195]             PowerOff-MainZone [196]             PowerOn-MainZone [197]             QuickSelect1 [198]             QuickSelect2 [199]             QuickSelect3 [200]             RestorerMode [201]             Speaker [202]             TunerBand [203]             TunerMemory [204]             TunerMode [205]             VideoSelect [206]             Zone 2 Off [207]             Zone 2 On [208]             Zone 2 Volume Down [209]             Zone 2 Volume Up [210]             Zone 3 Off [211]             Zone 3 On [212]             Zone 3 Volume Down [213]             Zone 3 Volume Up [214]             Plus [215]             Eject [216]             TopMenu [217]             Subtitle [218]             Audio [219]             Angle [220]             Cross [221]             Circle [222]             Square [223]             Triangle [224]             Green [225]             Red [226]             Blue [227]             Yellow [228]             InstantLeft [229]             InstantRight [230]             L1 [231]             L2 [232]             L3 [233]             PS [234]             PSHold [235]             R1 [236]             R2 [237]             R3 [238]             SlowNext [239]             SlowPrev [240]             Start [241]             Time [242]             InputVAux [243]             InputDvr/Vcr [244]             InputV-Aux [245]             Reboot [246]     On [id=DON]     Off [id=DOF] ***Device*** Name: OSD Amp ID: n010_d60308902 Parent: Elite Hub5158 [ID: n010_h51415fc31d16b]   ***Accept Commands***     Command [id=SET_BUTTON]         Parameter 1: name=n/a [id=n/a]           Enum [uom id=25]             Mute [14]             PowerOff [0]             PowerOn [1]             PowerToggle [2]             Dot [3]             Number0 [4]             Number1 [5]             Number2 [6]             Number3 [7]             Number4 [8]             Number5 [9]             Number6 [10]             Number7 [11]             Number8 [12]             Number9 [13]             Mute [14]             VolumeDown [15]             VolumeUp [16]             PrevChannel [17]             ChannelDown [18]             ChannelUp [19]             DirectionDown [20]             DirectionLeft [21]             DirectionRight [22]             DirectionUp [23]             Select [24]             Stop [25]             Play [26]             Rewind [27]             Pause [28]             FastForward [29]             Return [30]             Menu [31]             PipSwap [32]             Exit [33]             Display [34]             AvSelection [35]             ChannelEnter [36]             Freeze [37]             HdmiControl [38]             Input1 [39]             Input2 [40]             Input3 [41]             Input4 [42]             Input5 [43]             Input6 [44]             Input7 [45]             InputPc [46]             PipShift [47]             PipSplit [48]             ScreenSize [49]             ServiceMenu [50]             Tools [51]             Tv/Dtv [52]             SkipBackward [53]             SkipForward [54]             Back [55]             PageDown [56]             PageUp [57]             Home [58]             NextChapter [59]             Pair [60]             PrevChapter [61]             Reset [62]             UnPair [63]             VideoMode [64]             In/OutMode [65]             Master [66]             MultiZone [67]             Slave [68]             Zone1 [69]             Zone2 [70]             Zone3 [71]             Zone4 [72]             Zone5 [73]             Zone6 [74]             Zone7 [75]             ZoneA [76]             ZoneB [77]             IR001 [78]             IR002 [79]             IR003 [80]             IR004 [81]             IR005 [82]             IR006 [83]             IR007 [84]             IR008 [85]             IR009 [86]             IR010 [87]             IR011 [88]             IR012 [89]             IR013 [90]             IR014 [91]             IR015 [92]             IR016 [93]             IR017 [94]             IR018 [95]             IR019 [96]             IR020 [97]             IR021 [98]             IR022 [99]             IR023 [100]             IR024 [101]             IR025 [102]             IR026 [103]             IR027 [104]             IR028 [105]             IR029 [106]             IR030 [107]             IR031 [108]             IR032 [109]             IR033 [110]             IR034 [111]             IR035 [112]             IR036 [113]             IR037 [114]             IR038 [115]             IR039 [116]             IR040 [117]             IR041 [118]             IR042 [119]             Search [120]             PrevPreset [121]             ScanDown [122]             ScanUp [123]             NextPreset [124]             Setup [125]             Sleep [126]             ChannelLevel [127]             DirectPlay-AllMusic/Favorites [128]             DirectPlay-USB [129]             DTUBand [130]             DTUBankA [131]             DTUBankB [132]             DTUBankC [133]             DTUBankD [134]             DTUBankE [135]             DTUBankF [136]             DTUBankG [137]             DTUKey0 [138]             DTUKey1 [139]             DTUKey2 [140]             DTUKey3 [141]             DTUKey4 [142]             DTUKey5 [143]             DTUKey6 [144]             DTUKey7 [145]             DTUKey8 [146]             DTUKey9 [147]             DTUMemory [148]             DTUTuneDown [149]             DTUTuneUp [150]             DTUTuningMode [151]             DynamicEq [152]             DynamicVolume [153]             InputCd [154]             InputDtu [155]             InputDvd [156]             InputDvr [157]             InputHdp [158]             InputiPod [159]             InputNet/Usb [160]             InputPhono [161]             InputSat/Cbl [162]             InputSatTu [163]             InputTuner [164]             InputTv [165]             InputV.Aux [166]             InputVcr [167]             IpodPause [168]             iPodRepeat [169]             iPodReturn [170]             iPodSearch [171]             iPodShuffle [172]             Mode5Ch/7Ch [173]             ModeCinema [174]             ModeDirect/Stereo [175]             ModeGame [176]             ModeMusic [177]             ModePure [178]             ModeSimu [179]             ModeStandard [180]             ModeStereo [181]             MonitorSelect [182]             MultiEq [183]             NetUsbD [184]             NetUsbDown [185]             NetUsbE [186]             NetUsbF [187]             NetUsbG [188]             NetUsbLeft [189]             NetUsbMemory [190]             NetUsbRight [191]             NetUsbSearch [192]             NetUsbSelect [193]             NetUsbUp [194]             Party [195]             PowerOff-MainZone [196]             PowerOn-MainZone [197]             QuickSelect1 [198]             QuickSelect2 [199]             QuickSelect3 [200]             RestorerMode [201]             Speaker [202]             TunerBand [203]             TunerMemory [204]             TunerMode [205]             VideoSelect [206]             Zone 2 Off [207]             Zone 2 On [208]             Zone 2 Volume Down [209]             Zone 2 Volume Up [210]             Zone 3 Off [211]             Zone 3 On [212]             Zone 3 Volume Down [213]             Zone 3 Volume Up [214]             Plus [215]             Eject [216]             TopMenu [217]             Subtitle [218]             Audio [219]             Angle [220]             Cross [221]             Circle [222]             Square [223]             Triangle [224]             Green [225]             Red [226]             Blue [227]             Yellow [228]             InstantLeft [229]             InstantRight [230]             L1 [231]             L2 [232]             L3 [233]             PS [234]             PSHold [235]             R1 [236]             R2 [237]             R3 [238]             SlowNext [239]             SlowPrev [240]             Start [241]             Time [242]             InputVAux [243]             InputDvr/Vcr [244]             InputV-Aux [245]             Reboot [246]     On [id=DON]     Off [id=DOF] USER QUERY: Turn on the Apple TV and OSD Amp and set Pioneer 2 to InputTv when I power on the Apple TV after 18:00."}, {"role": "assistant", "content": "__BEGIN_NUCORE_ROUTINE__\n{\n  \"routine\": {\n    \"id\": 101,\n    \"name\": \"Evening AppleTV power-on setup\",\n    \"parent\": 0,\n    \"comment\": \"When Apple TV is turned on between 18:00 and 23:00: power amp and set Pioneer input to InputTv\",\n    \"if\": [\n      { \"==\": { \"device\": \"n010_d60308905\", \"control\": \"DON\" } },\n      { \"and\": 1 },\n      { \"from\": { \"time\": \"18:00\", \"to\": { \"time\": \"23:00\", \"day\": 0 } } }\n    ],\n    \"then\": [\n      { \"device\": \"n010_d60308902\", \"command\": \"DON\", \"parameters\": [] },\n      { \"device\": \"n010_d60308906\", \"command\": \"SET_BUTTON\", \"parameters\": [ { \"name\": \"n/a\", \"value\": 165, \"uom\": \"25\", \"precision\": 0 } ] }\n    ],\n    \"else\": [],\n    \"reasoning\": \"Use a COC (Apple TV DON) during the evening window to trigger the AV setup. Turn the OSD Amp on with DON and send Pioneer2 a SET_BUTTON InputTv (enum 165) to switch input for immediate playback.\"\n  }\n}\n__END_NUCORE_ROUTINE__"}]}
