{"messages": [{"role": "system", "content": "You are a NuCore smart-home assistant. You convert the user\u2019s request into one or more NuCore routines based on the provided DEVICE STRUCTURE."}, {"role": "user", "content": "DEVICE STRUCTURE:\n***Device***\nName: Basement_Kpd.A\nID: 33 F 75 1\n***Device***\nName: Basement_Kpd.B\nID: 33 F 75 2\nParent: Basement_Kpd.A [ID: 33 F 75 1]\n***Device***\nName: Basement_Kpd.C\nID: 33 F 75 3\nParent: Basement_Kpd.A [ID: 33 F 75 1]\n\nUSER QUERY: When I double-tap the Basement_Kpd.A keypad (fast on) overnight (22:00 to 06:00), turn Basement_Kpd.B on to 100%, set its backlight to the \"On 1 / Off 0\" profile, and set Basement_Kpd.A ramp rate to 0.5 seconds for immediate response."}, {"role": "assistant", "content": "__BEGIN_NUCORE_ROUTINE__\n{\n  \"routine\": {\n    \"id\": 101,\n    \"name\": \"Overnight double-tap: turn on B, set backlight, set A ramp rate\",\n    \"parent\": 0,\n    \"comment\": \"Double-tap DFON on A between 22:00-06:00 -> turn on B at 100%, set B backlight, set A ramp rate to 0.5s\",\n    \"if\": [\n      { \"from\": { \"time\": \"22:00\", \"to\": { \"time\": \"06:00\", \"day\": 1 } } },\n      { \"and\": 1 },\n      { \"==\": { \"device\": \"33 F 75 1\", \"control\": \"DFON\", \"parameters\": [ { \"name\": \"tapCount\", \"value\": 2, \"uom\": \"108\", \"precision\": 0 } ] } }\n    ],\n    \"then\": [\n      { \"device\": \"33 F 75 2\", \"command\": \"DON\", \"parameters\": [ { \"name\": \"n/a\", \"value\": 100, \"uom\": \"51\", \"precision\": 0 } ] },\n      { \"device\": \"33 F 75 2\", \"command\": \"BL\", \"parameters\": [ { \"name\": \"n/a\", \"value\": 17, \"uom\": \"25\", \"precision\": 0 } ] },\n      { \"device\": \"33 F 75 1\", \"command\": \"RR\", \"parameters\": [ { \"name\": \"n/a\", \"value\": 28, \"uom\": \"25\", \"precision\": 0 } ] }\n    ],\n    \"else\": [],\n    \"reasoning\": \"This uses a COC (fast on DFON with tapCount=2) restricted to an overnight schedule so a user double-tap at night will reliably turn on child keypad B to full, enable a visible backlight profile, and set the parent device ramp rate to 0.5s (enum index 28) for immediate response.\"\n  }\n}\n__END_NUCORE_ROUTINE__"}]}
